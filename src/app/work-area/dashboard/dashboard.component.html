<div (mousedown)="checkCloseFilter($event)" id="closeFilter" class="pb-5 h-full bg-blancb flex flex-col select-none">
  <div *ngIf="categories.length < 1" class="my-auto mx-auto text-center flex flex-col">
    <h1 class="text-4xl font-extrabold uppercase text-blauf mb-2">THERE ARE NO CATEGORIES</h1>
    <h2 (click)="showCat = true" class="text-2xl font-extrabold uppercase text-blancb py-2 px-4 rounded-full bg-blauf mx-auto hover:scale-105 drop-shadow-md transition-all duration-300 cursor-pointer">CREATE NEW CATEGORY</h2>
  </div>
  <div id="closeFilter" *ngIf="categories.length >= 1" class="px-10 pb-20 md:pb-1 w-full h-full relative flex flex-col md:flex-row gap-10 overflow-auto pt-20">
    <div *ngFor="let category of categories | filterCategory" class="flex flex-col min-w-[300px] max-w-[300px] rounded-md shadow-md mb-auto border-t-2 mx-auto md:mx-0" [ngStyle]="{'border-top-color': category.color}">
      <h3 id="closeFilter" class="px-10 py-4 text-center font-extrabold text-3xl shadow-md relative group">
        {{ category.name }} 
        <svg (click)="editCategory(category)" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 absolute top-2 right-2 cursor-pointer {{ category == categoryEdit ? 'opacity-100':'opacity-0'}} group-hover:opacity-100 transition-all duration-300" viewBox="0 0 512 512"><path d="M262.29 192.31a64 64 0 1057.4 57.4 64.13 64.13 0 00-57.4-57.4zM416.39 256a154.34 154.34 0 01-1.53 20.79l45.21 35.46a10.81 10.81 0 012.45 13.75l-42.77 74a10.81 10.81 0 01-13.14 4.59l-44.9-18.08a16.11 16.11 0 00-15.17 1.75A164.48 164.48 0 01325 400.8a15.94 15.94 0 00-8.82 12.14l-6.73 47.89a11.08 11.08 0 01-10.68 9.17h-85.54a11.11 11.11 0 01-10.69-8.87l-6.72-47.82a16.07 16.07 0 00-9-12.22 155.3 155.3 0 01-21.46-12.57 16 16 0 00-15.11-1.71l-44.89 18.07a10.81 10.81 0 01-13.14-4.58l-42.77-74a10.8 10.8 0 012.45-13.75l38.21-30a16.05 16.05 0 006-14.08c-.36-4.17-.58-8.33-.58-12.5s.21-8.27.58-12.35a16 16 0 00-6.07-13.94l-38.19-30A10.81 10.81 0 0149.48 186l42.77-74a10.81 10.81 0 0113.14-4.59l44.9 18.08a16.11 16.11 0 0015.17-1.75A164.48 164.48 0 01187 111.2a15.94 15.94 0 008.82-12.14l6.73-47.89A11.08 11.08 0 01213.23 42h85.54a11.11 11.11 0 0110.69 8.87l6.72 47.82a16.07 16.07 0 009 12.22 155.3 155.3 0 0121.46 12.57 16 16 0 0015.11 1.71l44.89-18.07a10.81 10.81 0 0113.14 4.58l42.77 74a10.8 10.8 0 01-2.45 13.75l-38.21 30a16.05 16.05 0 00-6.05 14.08c.33 4.14.55 8.3.55 12.47z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/></svg>
        <svg (click)="toggleFilter(category)" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 absolute bottom-2 right-2 cursor-pointer {{ category == categoryFilter ? 'opacity-100':'opacity-0'}} group-hover:opacity-100 transition-all duration-300" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M368 128h80M64 128h240M368 384h80M64 384h240M208 256h240M64 256h80"/><circle cx="336" cy="128" r="32" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/><circle cx="176" cy="256" r="32" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/><circle cx="336" cy="384" r="32" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/></svg>
        <div *ngIf="category == categoryFilter" class="absolute bottom-0 translate-y-full backdrop-blur-sm bg-[#ffffff8f] rounded-lg shadow-md w-full left-0 p-4 z-10">
          <p>Sort</p>
          <div class="flex flex-col justify-around gap-2 mt-3">
            <button (click)="setCategory(category,'date')" class="text-base flex justify-center transition-all duration-300 px-4 py-2 border-2 border-blauf rounded-full {{ category.filter.includes('date') ? 'text-blauf bg-blancb':'hover:text-blauf hover:bg-blancb bg-blauf text-blancb'}}"><span class="my-auto">Date</span> <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 my-auto transition-transform duration-500 {{ category.filter == 'date' ? 'rotate-180':''}}" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M112 244l144-144 144 144M256 120v292"/></svg></button>
            <button (click)="setCategory(category,'difficulty')" class="text-base flex justify-center transition-all duration-300 px-4 py-2 border-2 border-blauf rounded-full {{ category.filter.includes('difficulty') ? 'text-blauf bg-blancb':'hover:text-blauf hover:bg-blancb bg-blauf text-blancb'}}"><span class="my-auto">Difficulty</span> <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 my-auto transition-transform duration-500 {{ category.filter == 'difficulty' ? 'rotate-180':''}}" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M112 244l144-144 144 144M256 120v292"/></svg></button>
          </div>
        </div>
      </h3>
      <div class="overflow-auto flex flex-col gap-5 pb-2 md:max-h-[70vh] pt-5">
        <div *ngFor="let task of category.tasks | filterTasks: category.filter" (click)="navigate($event,task,checkTracking(task,true))" class="mx-4 rounded-md shadow-md px-4 py-2 bg-[#00000015] relative cursor-pointer">
          <p class="text-lg uppercase font-semibold pr-10">{{ task.title != (task.title | slice:0:40) ? (task.title | slice:0:40) + "...":task.title }}</p>
          <p class="text-sm">{{ task.description != (task.description | slice:0:40) ? (task.description | slice:0:40) + "...":task.description }}</p>
          <div class="text-sm flex justify-between mt-2">
            <p class="opacity-50">{{ task.date | date:'dd/MM/yyyy' }}</p>
            <p id="track" class="flex">
              <span id="track">{{ calcHours(task.tracking) }}&nbsp;</span>
              <svg id="track" *ngIf="checkTracking(task,true)" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500" viewBox="0 0 512 512"><path id="track" fill="currentColor" d="M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm74.77 217.3l-114.45 69.14a10.78 10.78 0 01-16.32-9.31V186.87a10.78 10.78 0 0116.32-9.31l114.45 69.14a10.89 10.89 0 010 18.6z"/></svg>
              <svg id="track" *ngIf="checkTracking(task,false)" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500" viewBox="0 0 512 512"><path id="track" fill="currentColor" d="M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48zm80 262.4a25.62 25.62 0 01-25.6 25.6H201.6a25.62 25.62 0 01-25.6-25.6V201.6a25.62 25.62 0 0125.6-25.6h108.8a25.62 25.62 0 0125.6 25.6z"/></svg>
            </p>
          </div>
          <p class="absolute text-sm flex top-2 right-4">
            <span class="my-auto">{{ task.difficulty }}&nbsp;</span>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-500 my-auto" viewBox="0 0 512 512"><path fill="currentColor" d="M394 480a16 16 0 01-9.39-3L256 383.76 127.39 477a16 16 0 01-24.55-18.08L153 310.35 23 221.2a16 16 0 019-29.2h160.38l48.4-148.95a16 16 0 0130.44 0l48.4 149H480a16 16 0 019.05 29.2L359 310.35l50.13 148.53A16 16 0 01394 480z"/></svg>
          </p>
        </div>
      </div>
      <p class="flex mx-auto font-bold bg-blauf text-blancb px-4 py-2 mb-5 rounded-full cursor-pointer mt-5" (click)="newTask(category._id)"><span class="my-auto pr-2">New task</span> <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 my-auto" viewBox="0 0 512 512"><path d="M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M256 176v160M336 256H176"/></svg></p>
    </div>
    <p class="flex mx-auto font-bold bg-blauf text-blancb px-4 py-2 rounded-full fixed bottom-5 right-5 cursor-pointer" (click)="showCat = true"> <span class="my-auto pr-2">New category</span> <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 my-auto" viewBox="0 0 512 512"><path d="M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M256 176v160M336 256H176"/></svg></p>
  </div>
</div>
<app-create-category (closePopup)="checkCategories($event)" [show]="showCat" [idProject]="idProject" [categoryEdit]="categoryEdit"></app-create-category>
<app-create-task (closePopup)="checkTask($event)" [show]="showTask" [idProject]="idProject" [idCategory]="idCategory"></app-create-task>
<router-outlet></router-outlet>