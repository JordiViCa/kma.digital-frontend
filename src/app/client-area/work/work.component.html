<div (mousedown)="checkCloseFilter($event)" id="closeFilter" class="pb-5 h-full bg-blancb flex flex-col select-none">
  <div *ngIf="categories.length < 1" class="my-auto mx-auto text-center flex flex-col">
    <h1 class="text-4xl font-extrabold uppercase text-blauf mb-2">THERE ARE NO CATEGORIES</h1>
    <h1 class="text-2xl font-extrabold uppercase text-blauf mb-2">WAIT TO PROJECT INITIATION</h1>
  </div>
  <div id="closeFilter" *ngIf="categories.length >= 1" class="px-2 md:px-10 pb-20 md:pb-1 w-full h-full relative flex flex-col md:flex-row gap-10 overflow-auto pt-20">
    <div *ngFor="let category of categories | filterCategory" class="flex pb-5 flex-col min-w-[300px] max-w-[300px] rounded-md shadow-md mb-auto border-t-2 mx-auto md:mx-0" [ngStyle]="{'border-top-color': category.color}">
      <div id="closeFilter" class="px-10 py-4 text-center font-extrabold text-3xl shadow-md relative group">
        {{ category.name }} 
        <svg (click)="toggleFilter(category)" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 absolute bottom-2 right-2 cursor-pointer {{ category == categoryFilter ? 'opacity-100':'opacity-0'}} group-hover:opacity-100 transition-all duration-300" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M368 128h80M64 128h240M368 384h80M64 384h240M208 256h240M64 256h80"/><circle cx="336" cy="128" r="32" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/><circle cx="176" cy="256" r="32" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/><circle cx="336" cy="384" r="32" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/></svg>
        <div *ngIf="category == categoryFilter" class="absolute bottom-0 translate-y-full backdrop-blur-sm bg-[#ffffff8f] rounded-lg shadow-md w-full left-0 p-4 z-10">
          <p>Sort</p>
          <div class="flex flex-col justify-around gap-2 mt-3">
            <button (click)="setCategory(category,'date')" class="text-base flex justify-center transition-all duration-300 px-4 py-2 border-2 border-blauf rounded-full {{ category.filter.includes('date') ? 'text-blauf bg-blancb':'hover:text-blauf hover:bg-blancb bg-blauf text-blancb'}}"><span class="my-auto">Date</span> <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 my-auto transition-transform duration-500 {{ category.filter == 'date' ? 'rotate-180':''}}" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M112 244l144-144 144 144M256 120v292"/></svg></button>
            <button (click)="setCategory(category,'difficulty')" class="text-base flex justify-center transition-all duration-300 px-4 py-2 border-2 border-blauf rounded-full {{ category.filter.includes('difficulty') ? 'text-blauf bg-blancb':'hover:text-blauf hover:bg-blancb bg-blauf text-blancb'}}"><span class="my-auto">Difficulty</span> <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 my-auto transition-transform duration-500 {{ category.filter == 'difficulty' ? 'rotate-180':''}}" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M112 244l144-144 144 144M256 120v292"/></svg></button>
          </div>
        </div>
      </div>
      <div class="overflow-auto flex flex-col gap-5 pb-2 md:max-h-[70vh] pt-5 w-full">
        <div *ngFor="let task of category.tasks | filterTasks: category.filter" (click)="navigate($event,task)" class="mx-4 rounded-md shadow-md px-4 py-2 bg-[#00000015] relative cursor-pointer">
          <p class="text-lg uppercase font-semibold pr-10">{{ task.title != (task.title | slice:0:40) ? (task.title | slice:0:40) + "...":task.title }}</p>
          <p class="text-sm">{{ task.description != (task.description | slice:0:40) ? (task.description | slice:0:40) + "...":task.description }}</p>
          <div class="text-sm flex justify-between mt-2">
            <p class="opacity-50">{{ task.date | date:'dd/MM/yyyy' }}</p>
            <p id="track" class="flex">
              <span id="track">{{ calcHours(task.tracking) }}&nbsp;</span>
            </p>
          </div>
          <p class="absolute text-sm flex top-2 right-4">
            <span class="my-auto">{{ task.difficulty }}&nbsp;</span>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-500 my-auto" viewBox="0 0 512 512"><path fill="currentColor" d="M394 480a16 16 0 01-9.39-3L256 383.76 127.39 477a16 16 0 01-24.55-18.08L153 310.35 23 221.2a16 16 0 019-29.2h160.38l48.4-148.95a16 16 0 0130.44 0l48.4 149H480a16 16 0 019.05 29.2L359 310.35l50.13 148.53A16 16 0 01394 480z"/></svg>
          </p>
        </div>
        <div *ngIf="category.tasks && category.tasks.length == 0" class="flex flex-col">
          <p class="m-auto bg-blauf text-blancb uppercase font-semibold text-xl px-4 py-2 rounded-xl">There are no tasks</p>
        </div>
      </div>
    </div>
    <p class="flex mx-auto font-bold bg-blauf text-blancb px-4 py-2 rounded-full fixed bottom-5 right-5 cursor-pointer" (click)="show = true"> <span class="my-auto pr-2">Inform error</span> <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 my-auto" viewBox="0 0 512 512"><path d="M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M256 176v160M336 256H176"/></svg></p>
  </div>
</div>
<div *ngIf="show" (mousedown)="close($event)" id="closePopup" class="fixed p-3 top-0 bg-[#00000054] backdrop-blur-sm flex w-full h-full transition-all duration-200" (mousedown)="close($event)">
  <div class="flex min-w-[80vw] md:min-w-[50vw] md:flex-row flex-col bg-gradient-to-t md:bg-transparent from-blauf to-blaum transition-all duration-500 w-full md:w-auto m-auto overflow-hidden rounded-xl drop-shadow-xl shadow-xl select-none">
    <form (ngSubmit)="createTask()" class="flex flex-col mb-auto w-full p-10" [formGroup]="taskForm">
      <h1 class="text-2xl lg:text-4xl font-extrabold uppercase text-center mb-5 text-blancb">CREATE TASK</h1>
      <label class="block relative mb-4 w-full group">
        <span class="text-blancb uppercase text-lg pl-2">Title</span>
        <input class="text-[#2b2b2b] border-b-2 w-full rounded-xl border-0 drop-shadow-md hover:drop-shadow-lg focus:drop-shadow-lg shadow-sm focus:shadow-lg transition-all duration-200 outline-none focus:outline-none ring-0 focus:ring-0 {{ taskForm.controls['title'].invalid && taskForm.controls['title'].touched ? 'border-error animate-error':taskForm.controls['title'].touched ? 'border-correct':''}}" type="text" formControlName="title" name="title" required="required">
      </label>
      <label class="block relative mb-4 w-full group">
        <span class="text-blancb uppercase text-lg pl-2">Description</span>
        <textarea class="text-[#2b2b2b] resize-none h-40 border-b-2 w-full rounded-xl border-0 drop-shadow-md hover:drop-shadow-lg focus:drop-shadow-lg shadow-sm focus:shadow-lg transition-all duration-200 outline-none focus:outline-none ring-0 focus:ring-0 {{ taskForm.controls['description'].invalid && taskForm.controls['description'].touched ? 'border-error animate-error':taskForm.controls['description'].touched ? 'border-correct':''}}" type="text" formControlName="description" name="description" required="required"></textarea>
      </label>
      <div class="w-full pb-4">
        <button class="text-blancb float-right bg-blue-700 hover:bg-blue-800 disabled:hover:bg-blue-700 disabled:opacity-70 disabled:cursor-not-allowed outline-none font-medium rounded-full px-10 py-2 text-center mx-auto text-lg drop-shadow-xl" type="submit" [disabled]="!taskForm.valid">
          Create
        </button>
      </div>
    </form>
  </div>
</div>
<router-outlet></router-outlet>